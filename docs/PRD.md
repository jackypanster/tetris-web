## PRD.md（產品需求說明）— Tetris Web 版
**目標**：實現在桌面瀏覽器可 60FPS 流暢運行的 Tetris，提供高分榜後端 API，支持本地離線遊玩。

**核心玩法**：
- 10×20 棋盤，7 種方塊（I, O, T, S, Z, J, L），**Bag-7** 隨機器。
- 旋轉系統採用 **簡化 SRS**，含牆踢；支持 **soft drop / hard drop**；鎖定延遲（~500ms 可調）。
- 計分規則：單/雙/三/四消（Tetris）分值遞增；連擊/Back-to-Back 加成可選。
- 升級節奏：每若干行加速；目標 FPS ≥ 60，輸入延遲 P95 ≤ 16ms。

**最小可行後端**：
- 高分榜（匿名暱稱 + 分數 + 版本 + 客戶端指紋簡要），僅存近 14 天或 Top-N；可關閉。

**非功能性約束**：
- **性能**：常規 1080p/60Hz 裝置下，渲染與邏輯合計 < 16ms/frame。
- **可測性**：旋轉、消行、隨機器、鎖定延遲、計分均有單元測試；E2E 檢驗核心操作序列。
- **安全/隱私**：高分榜不得存儲個人敏感信息；輸入需基本校驗與速率限制。
- **可觀測**：最少矩陣：行消次數、平均下落速度、最大連擊、渲染耗時分佈（開發模式）。

**平台與技術**：TypeScript + HTML Canvas（或 WebGL 可選），Vite 構建；Node/Express 作簡易高分榜 API。

## Tetris 需求細化（便於 Claude 實作）
- **棋盤/方塊**：
  - `Board`：二維陣列 + 消行判定 + 行下沉；
  - `Piece`：形狀矩陣 + 旋轉表 + 踢牆表（簡化 SRS）。
- **隨機器**：`Bag7`：每包七子亂序，取空則重置新包；
- **狀態機**：`Spawn → Active → Lock → Clear → Over`；支持暫停；
- **控制**：Left/Right（連發），Rotate CW/CCW/180（可選），Soft/Hard Drop，Hold（可選）；
- **渲染**：`render()` 每幀：清屏 → 畫場景 → 畫投影影子（Ghost Piece）；
- **音效/皮膚**：可留空，放入 TODO。

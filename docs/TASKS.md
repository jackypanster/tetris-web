# TASKS.md — 里程碑與未完項（更新：2025-09）

> 本表整理目前程式碼所對應的狀態與後續待辦。產品範圍請見 `docs/PRD.md`，技術結構請見 `docs/ARCH.md`。

## 1. 里程碑現況
| 節點 | 說明 | 狀態 |
|------|------|------|
| M1 | 最小可玩遊戲：核心落子、下一顆預覽、基本計分 | ✅ 完成 |
| M2 | 排行榜整合：前端自動提交、後端 API、佇列重送 | ✅ 完成 |
| M3 | 文件與建置同步：手動更新 PRD/ARCH/Acceptance/TESTPLAN，`pnpm run build` 通過 | ✅ 完成 |
| M4 | 自動化測試與 CI Gate（覆蓋率、lint、型別檢查） | ⏳ 未啟動 |
| M5 | 永續儲存與 Service Worker 緩存 | ⏳ 未啟動 |

## 2. 待辦列表
| 類別 | 任務 | 優先級 | 註解 |
|------|------|--------|------|
| 測試 | 建立 TetrisGame 行為單元測試與 ScoreClient API 測試 | 高 | 目前僅手動驗證，需至少落實 Vitest + Pytest 基礎案例 |
| 架構 | 將記憶體儲存改為 SQLite/雲端持久化 | 中 | 後端重啟即清空資料，部署前需解決 |
| 體驗 | 改用 Bag-7 隨機器並補強旋轉踢牆測試 | 中 | 目前僅隨機抽樣三顆預覽 |
| 體驗 | 完成 Service Worker 資源快取與離線 Loading UI | 中 | 現階段僅以 localStorage 佇列分數 |
| 文檔 | 自動化產生 API 型別（`pnpm run generate:api`）納入 CICD | 中 | 避免型別手動更新遺漏 |
| 整合 | 加入 GitHub Actions 或其他 CI 管線，執行 `pnpm run build` 與後端測試 | 低 | 手動流程需自動化以防回歸 |

## 3. 風險與注意事項
- **資料揮發**：排行榜資料僅存在記憶體；部署前需優先完成永續化。
- **測試缺位**：未建立自動化測試，開發修改容易引入回歸。
- **佇列同步**：`localStorage` 容量有限；若大量離線分數，批次上傳仍可能失敗，需要 UI 介面讓玩家手動清理。
- **佈署流程**：目前僅記錄 dev 指令；正式佈署需補充容器化或伺服器設定文檔。
